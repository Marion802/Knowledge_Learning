{% extends "base.html" %}

{% block content %}
<h1>{{ course.title }}</h1>
<p>{{ course.description }}</p>

<h2>Lessons</h2>

{% if user.is_authenticated %}
    {% if has_purchased or is_validated %}
        <!-- Course already owned or validated -->
        <p class="success">
            You already have access to this course.
        </p>
    {% else %}
        <!-- Course can be purchased -->
        <a class="btn" href="{% url 'buy_course' course.id %}">
            Buy this course
        </a>
    {% endif %}
{% else %}
    <p>Please log in to buy this course.</p>
{% endif %}

<ul>
{% for lesson in course.lessons.all %}
    <li>
        <a href="{% url 'lesson_detail' lesson.id %}">
            {{ lesson.title }} – {{ lesson.price }} €
        </a>
    </li>
{% endfor %}
</ul>
{% endblock %}

