{% extends "base.html" %}

{% block content %}
<h1>{{ lesson.title }}</h1>

{% if has_access %}
    <!-- Lesson content accessible -->
    <p>{{ lesson.content }}</p>

    <iframe
        width="560"
        height="315"
        src="{{ lesson.video_url }}"
        frameborder="0"
        allowfullscreen>
    </iframe>

    {% if is_validated %}
        <!-- Lesson already validated -->
        <p class="success">
            Lesson already validated.
        </p>
    {% else %}
        <!-- Lesson validation form -->
        <form method="post" action="{% url 'validate_lesson' lesson.id %}">
            {% csrf_token %}
            <button type="submit" class="btn">
                Validate this lesson
            </button>
        </form>
    {% endif %}
{% else %}
    <!-- No access to lesson -->
    <p class="warning">
        You must purchase this lesson or the related course to access the content.
    </p>

    <a class="btn" href="{% url 'buy_lesson' lesson.id %}">
        Buy this lesson
    </a>
{% endif %}
{% endblock %}
